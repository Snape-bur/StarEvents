@model StarEvents.Models.ViewModels.CustomerHomeVM

@{
    ViewData["Title"] = "Welcome";
}

<div class="max-w-7xl mx-auto mt-10 px-4 space-y-10">

    <!-- 🔹 Welcome + Loyalty Card -->
    <section class="grid gap-6 md:grid-cols-3">

        <!-- Left: Welcome -->
        <div class="md:col-span-2">
            <div class="relative overflow-hidden rounded-3xl bg-gradient-to-r from-primary-600 to-primary-500 p-8 text-white shadow-xl">
                <div class="relative z-10 space-y-3">
                    <p class="text-sm uppercase tracking-wide text-primary-100/90">
                        Customer Dashboard
                    </p>

                    <h1 class="text-3xl font-extrabold sm:text-4xl">
                        Hi, @Model.FirstName 👋
                    </h1>

                    <p class="max-w-xl text-sm sm:text-base text-primary-100">
                        Discover upcoming events, manage your bookings, and use your loyalty points
                        to save on tickets.
                    </p>

                    <div class="mt-4 flex flex-wrap gap-3 text-xs sm:text-sm">
                        <a asp-area="Customer"
                           asp-controller="Event"
                           asp-action="Index"
                           class="inline-flex items-center rounded-2xl bg-white px-4 py-2 font-semibold text-primary-700 shadow-md shadow-black/10 transition hover:bg-primary-50 active:scale-[0.98]">
                            Browse All Events
                        </a>
                        <a asp-area="Customer"
                           asp-controller="Booking"
                           asp-action="MyBookings"
                           class="inline-flex items-center rounded-2xl bg-white/10 px-4 py-2 font-semibold text-white ring-1 ring-white/40 backdrop-blur hover:bg-white/15 active:scale-[0.98]">
                            View My Bookings
                        </a>
                    </div>
                </div>

                <!-- decorative circle -->
                <div class="pointer-events-none absolute -right-10 -top-10 h-40 w-40 rounded-full bg-white/10 blur-xl"></div>
            </div>
        </div>

        <!-- Right: Loyalty Points -->
        <div class="flex flex-col justify-between rounded-3xl bg-white p-6 shadow-xl ring-1 ring-gray-200">
            <div>
                <p class="text-xs font-semibold uppercase tracking-wide text-gray-500">
                    Loyalty Points
                </p>
                <p class="mt-2 text-3xl font-extrabold text-primary-600">
                    @Model.LoyaltyPoints
                    <span class="text-base font-medium text-gray-500">pts</span>
                </p>
                <p class="mt-2 text-xs text-gray-500">
                    Earn points for every successful payment and redeem them at checkout
                    for up to <span class="font-semibold text-primary-600">50% off</span>.
                </p>
            </div>

            <div class="mt-4 flex justify-between items-center text-xs text-gray-500">
                <span>Use points on your next booking</span>
                <a asp-area="Customer"
                   asp-controller="Profile"
                   asp-action="Index"
                   class="font-semibold text-primary-600 hover:text-primary-700">
                    View Profile →
                </a>
            </div>
        </div>
    </section>

    <!-- 🔹 Section: Recent Bookings -->
    @if (Model.RecentBookings != null && Model.RecentBookings.Any())
    {
        <section class="space-y-4">
            <div class="flex items-center justify-between">
                <h2 class="text-lg font-bold text-gray-900">
                    🎫 Your Recent Tickets
                </h2>
                <a asp-area="Customer"
                   asp-controller="Booking"
                   asp-action="MyBookings"
                   class="text-xs font-semibold text-primary-600 hover:text-primary-700">
                    View all bookings →
                </a>
            </div>

            <div class="overflow-hidden rounded-2xl border border-gray-100 bg-white shadow-sm">
                <table class="min-w-full text-sm text-gray-700">
                    <thead class="bg-gray-50 text-xs font-semibold uppercase text-gray-500">
                        <tr>
                            <th class="px-4 py-3 text-left">Event</th>
                            <th class="px-4 py-3 text-left">Venue</th>
                            <th class="px-4 py-3 text-center">Tickets</th>
                            <th class="px-4 py-3 text-center">Paid</th>
                            <th class="px-4 py-3 text-center">Date</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100">
                        @foreach (var b in Model.RecentBookings)
                        {
                            <tr class="hover:bg-gray-50/80 transition">
                                <td class="px-4 py-3 font-medium text-gray-900">
                                    @b.Event?.Title
                                </td>
                                <td class="px-4 py-3 text-gray-600">
                                    @b.Event?.Venue?.Name
                                </td>
                                <td class="px-4 py-3 text-center">
                                    @b.Quantity
                                </td>
                                <td class="px-4 py-3 text-center font-semibold text-primary-600">
                                    $@b.FinalPrice.ToString("0.00")
                                </td>
                                <td class="px-4 py-3 text-center text-xs text-gray-500">
                                    @b.BookingDate.ToString("dd MMM yyyy")
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </section>
    }

    <!-- 🔹 Section: Upcoming Events -->
    <section class="space-y-4" id="upcoming">
        <div class="flex items-center justify-between">
            <div>
                <h2 class="text-xl font-extrabold text-gray-900">
                    🔥 Upcoming Events
                </h2>
                <p class="text-sm text-gray-500">
                    Hand-picked events happening soon. Don’t miss out.
                </p>
            </div>
            <a asp-area="Customer"
               asp-controller="Event"
               asp-action="Index"
               class="hidden text-xs font-semibold text-primary-600 hover:text-primary-700 sm:inline-block">
                Browse all →
            </a>
        </div>

        @if (Model.UpcomingEvents == null || !Model.UpcomingEvents.Any())
        {
            <div class="rounded-2xl border border-dashed border-gray-300 bg-gray-50 p-8 text-center text-gray-500">
                No upcoming events are available right now. Please check back soon.
            </div>
        }
        else
        {
            <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
                @foreach (var e in Model.UpcomingEvents)
                {
                    <article class="flex h-full flex-col rounded-2xl bg-white p-5 shadow-md ring-1 ring-gray-200 transition hover:-translate-y-1 hover:shadow-lg">
                        <!-- Category + Date badge -->
                        <div class="mb-3 flex items-center justify-between text-xs text-gray-500">
                            <span class="rounded-full bg-primary-50 px-3 py-1 font-semibold text-primary-700">
                                @e.Category?.Name ?? "Event"
                            </span>
                            <span>
                                @e.StartDate.ToString("dd MMM yyyy")
                            </span>
                        </div>

                        <h3 class="line-clamp-2 text-lg font-bold text-gray-900">
                            @e.Title
                        </h3>

                        <p class="mt-2 line-clamp-3 text-sm text-gray-600">
                            @e.Description
                        </p>

                        <div class="mt-3 space-y-1 text-sm text-gray-700">
                            <p>
                                📍 <span class="font-semibold">@e.Venue?.Name</span>
                                <span class="text-gray-500"> · @e.Venue?.Location</span>
                            </p>
                            <p>
                                ⏰ @e.StartDate.ToString("hh:mm tt")
                            </p>
                        </div>

                        <div class="mt-4 flex items-center justify-between">
                            <p class="text-base font-semibold text-primary-600">
                                💲@e.TicketPrice.ToString("0.00")
                            </p>
                            <a asp-area="Customer"
                               asp-controller="Home"
                               asp-action="Details"
                               asp-route-id="@e.EventId"
                               class="inline-flex items-center rounded-xl bg-primary-600 px-4 py-2 text-xs font-semibold text-white shadow-md shadow-primary-600/30 transition hover:bg-primary-700 active:scale-[0.97]">
                                View Details
                            </a>
                        </div>
                    </article>
                }
            </div>
        }
    </section>

    <!-- 🔹 CTA -->
    <section class="pb-10 pt-4">
        <div class="rounded-3xl bg-gradient-to-r from-primary-600 to-primary-500 px-6 py-7 text-white shadow-xl sm:flex sm:items-center sm:justify-between">
            <div>
                <h2 class="text-xl font-extrabold sm:text-2xl">
                    Ready for your next live experience?
                </h2>
                <p class="mt-1 text-sm text-primary-100">
                    Use your loyalty points at checkout and grab the best seats before they sell out.
                </p>
            </div>
            <div class="mt-4 sm:mt-0">
                <a asp-area="Customer"
                   asp-controller="Event"
                   asp-action="Index"
                   class="inline-flex items-center rounded-2xl bg-white px-5 py-2.5 text-sm font-semibold text-primary-700 shadow-md shadow-black/10 transition hover:bg-primary-50 active:scale-[0.97]">
                    Find Events
                </a>
            </div>
        </div>
    </section>

</div>
 
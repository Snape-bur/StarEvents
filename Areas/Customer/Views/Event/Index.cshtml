@model StarEvents.Models.ViewModels.EventBrowseVM

@{
    ViewData["Title"] = "Events";
}

<div class="max-w-7xl mx-auto mt-10 px-4">
    <h2 class="text-3xl font-bold text-blue-700 mb-6">Upcoming Events</h2>

    <!-- 🔍 Filters -->
    <form method="get" class="bg-white rounded-xl shadow ring-1 ring-black/5 p-5 mb-6 grid grid-cols-1 md:grid-cols-6 gap-3">
        <input type="text" name="Keyword" value="@Model.Keyword" placeholder="Search title, venue, location..."
               class="md:col-span-2 border rounded-lg px-3 py-2" />

        <select name="CategoryId" class="border rounded-lg px-3 py-2">
            <option value="">All Categories</option>
            @foreach (var c in Model.Categories)
            {
                <option value="@c.Value" selected="@(Model.CategoryId?.ToString()==c.Value)">
                    @c.Text
                </option>
            }
        </select>

        <select name="VenueId" class="border rounded-lg px-3 py-2">
            <option value="">All Venues</option>
            @foreach (var v in Model.Venues)
            {
                <option value="@v.Value" selected="@(Model.VenueId?.ToString()==v.Value)">
                    @v.Text
                </option>
            }
        </select>

        <input type="date" name="DateFrom" value="@(Model.DateFrom?.ToString("yyyy-MM-dd"))"
               class="border rounded-lg px-3 py-2" />
        <input type="date" name="DateTo" value="@(Model.DateTo?.ToString("yyyy-MM-dd"))"
               class="border rounded-lg px-3 py-2" />

        <div class="md:col-span-4 flex gap-3">
            <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md">Search</button>
            <a href="@Url.Action("Index", "Event", new { area = "Customer" })"
               class="px-4 py-2 rounded-md border">Reset</a>
        </div>
    </form>

    <!-- 🎟 Event List -->
    @if (Model.Results == null || Model.Results.Count == 0)
    {
        <p class="text-gray-500 text-center py-10">No events found.</p>
    }
    else
    {
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            @foreach (var e in Model.Results)
            {
                <div class="bg-white rounded-2xl shadow ring-1 ring-black/5 p-5 flex flex-col justify-between">
                    <div>
                        <h3 class="text-xl font-semibold text-gray-900">@e.Title</h3>
                        <p class="text-gray-500 text-sm mt-1">@e.Venue?.Name</p>
                        <p class="text-gray-600 mt-2">@e.Description?.Substring(0, Math.Min(100, e.Description.Length))...</p>
                    </div>

                    <div class="mt-4 text-sm text-gray-500">
                        <p><strong>Date:</strong> @e.StartDate.ToString("MMM dd, yyyy")</p>
                        <p><strong>Price:</strong> $@e.TicketPrice.ToString("0.00")</p>
                        <p><strong>Available:</strong> @e.AvailableSeats seats</p>
                    </div>

                    <div class="mt-6 flex justify-between items-center">
                        <a asp-action="Details" asp-route-id="@e.EventId"
                           class="text-blue-600 hover:underline">View Details</a>

                        <a asp-area="Customer" asp-controller="Booking" asp-action="Create" asp-route-id="@e.EventId"
                           class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md shadow-md transition">
                            Book Now
                        </a>
                    </div>
                </div>
            }
        </div>
    }
</div>

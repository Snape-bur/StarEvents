@model IEnumerable<StarEvents.Models.Event>
@{
    ViewData["Title"] = "Manage Events";
}

<div class="p-6">
    <h1 class="text-2xl font-bold text-gray-800 mb-6">🎭 Event Management</h1>

    <!-- ✅ Filter -->
    <form method="get" asp-action="Manage" class="mb-6 flex gap-3 items-center">
        <select name="status" class="border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:ring-2">
            @foreach (var s in ViewBag.StatusList)
            {
                <option value="@s" selected="@(ViewBag.SelectedStatus == s)">@s</option>
            }
        </select>
        <button type="submit"
                class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
            Filter
        </button>
        <a asp-action="Manage" class="ml-2 text-sm text-gray-600 underline">Reset</a>
    </form>

    <!-- ✅ Table -->
    <div class="overflow-x-auto bg-white rounded-2xl shadow">
        <table class="min-w-full text-sm text-gray-700">
            <thead class="bg-blue-600 text-white">
                <tr>
                    <th class="py-3 px-4 text-left">Title</th>
                    <th class="py-3 px-4 text-left">Organizer</th>
                    <th class="py-3 px-4 text-left">Category</th>
                    <th class="py-3 px-4 text-left">Venue</th>
                    <th class="py-3 px-4 text-center">Start</th>
                    <th class="py-3 px-4 text-center">End</th>
                    <th class="py-3 px-4 text-center">Status</th>
                    <th class="py-3 px-4 text-center">Actions</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
                @foreach (var item in Model)
                {
                    <tr class="hover:bg-gray-50">
                        <td class="py-3 px-4 font-semibold">@item.Title</td>
                        <td class="py-3 px-4">@item.Organizer?.FullName</td>
                        <td class="py-3 px-4">@item.Category?.Name</td>
                        <td class="py-3 px-4">@item.Venue?.Location</td>
                        <td class="py-3 px-4 text-center">@item.StartDate.ToShortDateString()</td>
                        <td class="py-3 px-4 text-center">@item.EndDate.ToShortDateString()</td>
                        <td class="py-3 px-4 text-center">
                            @if (item.Status == "Approved")
                            {
                                <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-full">Approved</span>
                            }
                            else if (item.Status == "Rejected")
                            {
                                <span class="px-3 py-1 bg-red-100 text-red-700 text-xs font-semibold rounded-full">Rejected</span>
                            }
                            else
                            {
                                <span class="px-3 py-1 bg-yellow-100 text-yellow-700 text-xs font-semibold rounded-full">Pending</span>
                            }
                        </td>
                        <td class="py-3 px-4 text-center space-x-2">
                            @if (item.Status == "Pending")
                            {
                                <form asp-action="Approve" method="post" asp-route-id="@item.EventId" class="inline">
                                    <button type="submit"
                                            class="bg-green-600 text-white text-sm px-3 py-1 rounded hover:bg-green-700">
                                        Approve
                                    </button>
                                </form>
                                <form asp-action="Reject" method="post" asp-route-id="@item.EventId" class="inline">
                                    <button type="submit"
                                            class="bg-red-600 text-white text-sm px-3 py-1 rounded hover:bg-red-700">
                                        Reject
                                    </button>
                                </form>
                            }
                            else
                            {
                                <a asp-action="Details" asp-route-id="@item.EventId"
                                   class="text-blue-600 text-sm underline">View</a>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
